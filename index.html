<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Relatório de Retrabalhos e Perdas 2D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f3f4f6;
  margin:0;
  padding:12px;
}
.container{ max-width:420px; margin:auto; }
.card{
  background:#fff;
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.header{ display:flex; justify-content:space-between; align-items:flex-start; }
.header-left{ font-weight:bold; font-size:16px; line-height:1.2; }
.header-right{ font-size:14px; color:#6b7280; text-align:right; line-height:1.2; }
.divider{ height:1px; background:#e5e7eb; margin:10px 0; }

/* FORM INFO */
.info{
  display:grid;
  grid-template-columns:auto 1fr;
  gap:8px 10px;
  font-size:14px;
  align-items:center;
}
.info span{ color:#6b7280; white-space:nowrap; }

input, select, textarea{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-size:14px;
}
textarea{ resize:none; }

button{
  border:none;
  border-radius:10px;
  padding:10px;
  font-weight:bold;
  cursor:pointer;
}
.btn-add{ background:#e5e7eb; }
.btn-main{ background:#000; color:#fff; }

/* ✅ Ramais em linha baixa (tipo digitável) */
.ramais-box{
  border:1px solid #d1d5db;
  border-radius:8px;
  padding:6px 8px;
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  align-items:center;
  min-height:36px; /* mesma “altura” de input */
  background:#fff;
}
.ramal-pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 8px;
  border:1px solid #e5e7eb;
  border-radius:999px;
  font-size:14px;
  user-select:none;
}
.ramal-pill input{ width:auto; padding:0; margin:0; }

/* EDITOR */
.row{
  display:grid;
  grid-template-columns: 1.6fr 0.8fr 1.8fr 28px;
  gap:6px;
  margin-bottom:6px;
  align-items:center;
}
.row .motivo{
  font-size:14px;
  line-height:1.2;
  /* ✅ NÃO cortar - deixar visível */
  white-space:normal;
  word-break:break-word;
}
.remove{
  color:#dc2626;
  font-size:20px;
  text-align:center;
  cursor:pointer;
}
.total{ text-align:right; font-weight:bold; margin-top:6px; }

/* RELATÓRIO (FOTO) */
.report{
  background:#fff;
  border-radius:14px;
  padding:14px;
}
.reportTop{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
}
.reportMeta{
  display:grid;
  grid-template-columns:auto 1fr;
  gap:8px 10px;
  font-size:14px;
  margin-top:10px;
  align-items:center;
}
.reportMeta span{ color:#6b7280; white-space:nowrap; }

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
  margin-top:10px;
}
th, td{
  border:1px solid #e5e7eb;
  padding:8px;
  vertical-align:middle;
}
th{ background:#f9fafb; text-align:left; }

/* ✅ Motivo visível (pode quebrar linha) */
td:nth-child(1){
  white-space:normal;
  word-break:break-word;
  line-height:1.2;
}

/* colunas */
th:nth-child(2), td:nth-child(2){
  width:64px;
  text-align:center;
}
th:nth-child(3), td:nth-child(3){
  width:44%;
}

tfoot td{ font-weight:bold; }
.footer{ font-size:12px; color:#6b7280; margin-top:8px; }
</style>
</head>

<body>
<div class="container">

<!-- FORMULÁRIO -->
<div class="card">
  <div class="header">
    <div class="header-left">Grendene –<br>Impressão Digital</div>
    <div class="header-right">Relatório de retrabalhos e<br>perdas 2D</div>
  </div>

  <div class="divider"></div>

  <div class="info">
    <span>Responsável:</span>
    <input id="responsavel">

    <span>Turno:</span>
    <select id="turno">
      <option>1º</option>
      <option selected>2º</option>
      <option>3º</option>
    </select>

    <span>Data:</span>
    <input type="date" id="data">

    <span>Ramais:</span>
    <div class="ramais-box" id="ramaisBox">
      <label class="ramal-pill"><input type="checkbox" value="1">1</label>
      <label class="ramal-pill"><input type="checkbox" value="2">2</label>
      <label class="ramal-pill"><input type="checkbox" value="3">3</label>
      <label class="ramal-pill"><input type="checkbox" value="4">4</label>
      <label class="ramal-pill"><input type="checkbox" value="5">5</label>
      <label class="ramal-pill"><input type="checkbox" value="6">6</label>
    </div>
  </div>
</div>

<!-- BOTÃO -->
<div class="card">
  <button class="btn-add" onclick="addLinhaExtra()">Adicionar linha</button>
</div>

<!-- EDITOR -->
<div class="card" id="editor"></div>

<div class="total">Total: <span id="total">0</span></div>

<div class="card">
  <button class="btn-main" onclick="compartilhar()">Gerar & Compartilhar</button>
</div>

<!-- RELATÓRIO -->
<div class="card" id="relatorio" style="display:none;">
  <div class="report" id="foto">
    <div class="reportTop">
      <div><strong>Grendene –<br>Impressão Digital</strong></div>
      <div style="color:#6b7280;text-align:right">Relatório de retrabalhos e<br>perdas 2D</div>
    </div>

    <div class="divider"></div>

    <div class="reportMeta">
      <span>Responsável:</span><b id="r_responsavel"></b>
      <span>Turno:</span><b id="r_turno"></b>
      <span>Data:</span><b id="r_data"></b>
      <span>Ramais:</span><b id="r_ramais"></b>
    </div>

    <table>
      <thead>
        <tr>
          <th>Motivo</th>
          <th>Qtde.</th>
          <th>Justificativa</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
      <tfoot>
        <tr>
          <td>TOTAL</td>
          <td id="totalFinal"></td>
          <td></td>
        </tr>
      </tfoot>
    </table>

    <div class="footer">Gerado em <span id="geradoEm"></span></div>
  </div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
/* ✅ Só encurtamos 2 motivos (como você pediu) */
const MOTIVOS = [
  "Aplicação de base - imp",
  "Base - imp",
  "Falha de Impressão - imp",
  "Filete Branco - imp",
  "Logo sem definição - imp",
  "Manchas - imp",
  "Número Trocado - imp",
  "Perda de Injeção - imp",
  "Sem Impressão - imp",
  "Sujeira no inferior - imp",
  "Troca de Imagem - imp",
  "Lâminados falhas - imp"
];

const editor = document.getElementById("editor");
const totalEl = document.getElementById("total");

function addLinha(motivo){
  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `
    <div class="mot
